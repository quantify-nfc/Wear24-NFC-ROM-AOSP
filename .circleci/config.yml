version: 2
jobs:
  build:
    machine:
      image: circleci/classic:latest
      
      

    steps:
      - checkout
      - restore_cache:
          keys:
            - ccache-cache-cache
            - repo
      - run:
          name: AOSP Build
          command: |
            git config user.email "test@example.com"
            git config user.name "CircleCI"
            ./repo-setup.sh -n
            ./swap-file-setup.sh -n
            ./build.sh -n
            git gc
      - save_cache:
          key: ccache-cache-cache
          paths:
            - "~/.ccache"
      - save_cache:
          key: repo
          paths:
            - "./"
